(function($){$.Popups||($.Popups={});$.Popups.Collection||($.Popups.Collection=[]);$.Popups.Defaults={width:275,height:"auto",zIndex:210,positionBy:"auto",topOffset:15,leftOffset:15,mouseLeaveClose:!0,local:!1,showShadow:!0,shadowSteps:3,sourceAttribute:"rel",popupClass:null,hoverClass:"",closeText:"close",closeButton:null,showClose:!0,popupLoading:null,activation:"hover",allowFixedWidth:!1,allowAutoWidth:!1,getDataByKeyCode:13,allowLinkMouseLeaveClose:!1,scrollXVisible:!1,allowReduceMaxWidth:!1,delay:500,ajaxSettings:{dataType:"html",ajaxCache:!0,ajaxProcess:function(data){return data.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"")}}};$.fn.popups=function(options){var links=this,opts=$.extend(!0,{},$.Popups.Defaults,options||{});return new $.Popups.CreatePopupObj(opts,links)};$.Popups.CreatePopupObj=function(options,links){var popupIndex,popupObj,i;if(this.Links=links,popupIndex=$.Popups.Collection.length,options.popupIndex=this.popupIndex=popupIndex,options.popupClass||(options.popupClass="popup"),this.options=options,this.$popup=$('<div id="popup'+this.options.popupIndex+'" class="'+this.options.popupClass+'"><div class="popup-main"><div class="popup-inner" ><\/div><\/div><\/div>').appendTo("body").hide(),this.$popupLoading=$('<div id="popup-loading'+this.options.popupIndex+'" class="popup-loading">loading...<\/div>').insertBefore(this.$popup).hide(),this.$popupMain=$("#popup"+this.options.popupIndex+" .popup-main"),this.$popupInner=$("#popup"+this.options.popupIndex+" .popup-inner"),popupObj=this,this.options.showClose&&(this.options.closeButton?(this.options.closeButton.hide(),this.$closeLink=$(this.options.closeButton[0].outerHtml).addClass("popup-close")):this.$closeLink=$('<div class="popup-close"><a href="#">'+this.options.closeText+"<\/a><\/div>"),this.$closeLink.prependTo(this.$popupMain),this.$closeLink.bind("click",function(e){return popupObj.$popup.hide(),!1})),options.mouseLeaveClose?this.$popup.bind("mouseleave",function(e){return popupObj.$popup.hide(),this.blur(),!1}):this.$popup.unbind("mouseleave"),this.$popup.bind("mouseenter",function(e){$.Popups.Collection[popupIndex].pending=-1}),this.options.showShadow&&this.options.shadowSteps>0)for(i=this.options.shadowSteps;i>0;i--)this.popupShadow=$('<div class="popup-shadow"><\/div>').css({top:i,left:i,zIndex:this.options.zIndex-1,width:this.options.width,height:this.options.height}).prependTo(this.$popup);return this.$popup.css({zIndex:this.options.zIndex,width:this.options.width,height:this.options.height}),this.$popupLoading.css({zIndex:this.options.zIndex,width:this.options.width,height:this.options.height}),this.$popupMain.css({zIndex:this.options.zIndex}),links.each(function(index){popupObj.Links[index]=new $.PopupLink(popupObj,$(this),index,popupObj.popupIndex,popupObj.options)}),$.Popups.Collection.push(this),this};$.PopupLink=function(popupObj,linkElement,linkIndex,popupIndex,options){return this.initPopupLink(popupObj,linkElement,linkIndex,popupIndex,options)};$.extend($.PopupLink.prototype,{initPopupLink:function(popupObj,linkElement,linkIndex,popupIndex,options){this.popupObj=popupObj;this.link=linkElement;this.options=options;this.linkIndex=linkIndex;this.popupIndex=popupIndex;this.href=this.link.attr(options.sourceAttribute);this.cachedcontent=null;var obj=this,delay=this.options.delay;this.options.activation=="hover"?(this.link.bind("mouseenter",function(e){return $.Popups.Collection[popupIndex].pending=linkIndex,window.setTimeout(function(){$.Popups.Collection[popupIndex].pending==linkIndex&&(obj.popup(e),obj.options.hoverClass&&obj.link.addClass(obj.options.hoverClass))},delay),!1}),this.link.bind("mouseleave",function(e){return window.setTimeout(function(){obj.options.hoverClass&&obj.link.removeClass(obj.options.hoverClass);obj.options.allowLinkMouseLeaveClose&&$.Popups.Collection[popupIndex].pending==linkIndex&&obj.popupObj.$popup.hide()},delay),!1})):(this.options.activation=="click"?this.link.bind("click",function(e){return obj.popup(e),this.blur(),!1}):this.options.activation=="rightClick"&&this.link.bind("contextmenu",function(e){return obj.popup(e),this.blur(),!1}),this.link.bind("mouseleave",function(e){return obj.options.allowLinkMouseLeaveClose&&obj.popupObj.$popup.hide(),!1}))},popup:function(e){var obj=this,newleft,newtop,$prevIndex,src,$content;if(this.setFixedAndRightByPosition(),this.options.local){if(this.options.getSource)if(src=this.options.getSource.call(this.link),src)this.popupObj.$popupInner.html(src);else return;else $content=$(this.href+(/#\S+$/.test(this.href)?"":":eq("+this.linkIndex+")")).clone(!0).show(),this.popupObj.$popupInner.html($content);this.setPosition(e)}else this.options.ajaxSettings.ajaxCache&&this.cachedcontent!=null?(this.ajaxBeforeSend(null),this.ajaxSuccess(this.cachedcontent,"success"),this.ajaxComplete(null,null)):$.ajax({async:!0,url:this.href,beforeSend:function(xhr){obj.ajaxBeforeSend(xhr)},success:function(data,textStatus){obj.ajaxSuccess(data,textStatus)},complete:function(xhr,textStatus){obj.ajaxComplete(xhr,textStatus)},error:function(xhr,textStatus){obj.options.ajaxSettings.error?obj.options.ajaxSettings.error.call(obj.link,xhr,textStatus,$popup,$popupMain):$popupInner.html("<i>sorry, the contents could not be loaded<\/i>")}})},setCssToLoadAndPopup:function(newleft,newtop){this.popupObj.$popup.css({left:newleft,top:newtop});this.popupObj.$popupLoading.css({left:newleft,top:newtop})},setFixedAndRightByPosition:function(){if(this.options.positionBy=="fixed"){newleft=this.options.leftOffset;newtop=this.options.topOffset;this.setCssToLoadAndPopup(newleft,newtop);return}else if(this.options.positionBy=="rightBy"){newleft=this.link.position().left+this.link.width()+this.options.leftOffset;newtop=this.link.position().top+this.options.topOffset;this.setCssToLoadAndPopup(newleft,newtop);return}},setPosition:function(e){function autoVerticalPosition(pop){function findTotalOffset(obj){var ot=0;if(obj.offsetParent)do ot+=obj.offsetTop;while(obj=obj.offsetParent);return ot}var thetop,temptop=findTotalOffset(pop.link.get(0))-pop.options.topOffset*3+pop.link.outerHeight(),pageoffset;return pop.popupObj.$popup.css({left:newleft,top:temptop}).show(),thetop=findTotalOffset(pop.link.get(0))-pop.popupObj.$popup.innerHeight()+pop.options.topOffset,pop.popupObj.$popup.hide(),thetop<0&&(thetop=0),pageoffset=window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop,thetop<pageoffset&&(thetop=findTotalOffset(pop.link.get(0))-pop.options.topOffset+pop.link.outerHeight()),thetop<=0&&(thetop=findTotalOffset(pop.link.get(0))+pop.link.outerHeight()),thetop}var maxWidth=this.link.width();maxWidth<100&&(maxWidth=100);this.options.allowFixedWidth==!1&&maxWidth>=0&&this.popupObj.$popup.css("max-width",maxWidth+"px");this.options.allowAutoWidth==!0&&this.popupObj.$popup.css("max-width","auto");this.options.positionBy=="fixed"?(newleft=this.options.leftOffset,newtop=this.options.topOffset):this.options.positionBy=="rightBy"?(newleft=this.link.position().left+this.link.width()+this.options.leftOffset,newtop=this.link.position().top+this.options.topOffset):this.options.positionBy=="abovemouse"?(newleft=e.pageX+this.options.leftOffset,newtop=autoVerticalPosition(this)):this.options.positionBy=="above"?(newleft=this.link.offset().left+this.options.leftOffset,newtop=autoVerticalPosition(this)):(newleft=e.pageX+this.options.leftOffset,newtop=e.pageY+this.options.leftOffset);this.setCssToLoadAndPopup(newleft,newtop);this.popupObj.$popup.show()},hide:function(){this.popupObj.$popup.hide()},ajaxBeforeSend:function(xhr){this.options.ajaxSettings.beforeSend&&this.options.ajaxSettings.beforeSend.call(this.link,this.popupObj.$popup);this.popupObj.$popupInner.empty();this.popupObj.$popupLoading.show();this.popupObj.$popupMain.scrollTop(0)},ajaxSuccess:function(data,textStatus){var content=this.options.ajaxSettings.ajaxProcess.call(this.link,data);this.options.ajaxSettings.success&&this.options.ajaxSettings.success.call(this.link,data,this.popupObj.$popup,this.popupObj.$popupMain);this.cachedcontent=content;this.popupObj.$popupInner.html(content)},ajaxComplete:function(data,textStatus){this.options.ajaxSettings.ajaxComplete&&this.options.ajaxSettings.ajaxComplete.call(this.link,this.popupObj.$popup,this.popupObj.$popupMain);var popupHeight=this.options.height=="auto"?this.popupObj.$popup.height():parseInt(this.options.height,10),popupWidth=this.options.width=="auto"?this.popupObj.$popup.width():parseInt(this.options.width,10);popupHeight<300?this.popupObj.$popupMain.css({overflowY:"hidden"}):this.popupObj.$popupMain.css({overflowY:"scroll"});this.popupObj.$popup.parent().find(".popup-shadow").css({height:popupHeight,width:popupWidth});this.popupObj.$popupLoading.hide();this.popupObj.$popup.show();this.options.ajaxSettings.popupComplete&&(this.popupObj.$popupMain.scrollTop(0),this.options.ajaxSettings.popupComplete.call(this.link,this.popupObj.$popup,this.popupObj.$popupMain))}})})(jQuery);;
MTPS=window.MTPS||{};MTPS.Translation=window.MTPS.Translation||{};MTPS.Translation.maxPopupTextLength=1e3;MTPS.Translation.Sentence=function(ctrlId,source,approved,sentenceGuid,previous){this.source=source;this.approved=approved;this.sentenceGuid=sentenceGuid;this.previous=previous;this.ctrlId=ctrlId};MTPS.Translation.Sentence.prototype.getPopupText=function(){return MTPS.Translation.TranslationType=="0"?this.source:this.approved};MTPS.Translation.Sentence.prototype.selectCurrent=function(){this.ctrlId&&$("#"+this.ctrlId).addClass("SentenceHighlight")};MTPS.Translation.Sentence.prototype.deselectCurrent=function(){this.ctrlId&&$("#"+this.ctrlId).removeClass("SentenceHighlight")};MTPS.Translation.Sentence.prototype.getNext=function(){return this.next?($("#"+this.ctrlId).removeClass("SentenceHighlight"),$("#"+this.next).addClass("SentenceHighlight"),MTPS.Translation.MTSentences[this.next]):this};MTPS.Translation.Sentence.prototype.getPrevious=function(){return this.previous?($("#"+this.ctrlId).removeClass("SentenceHighlight"),$("#"+this.previous).addClass("SentenceHighlight"),MTPS.Translation.MTSentences[this.previous]):this};MTPS.Translation.getSource=function(){var sentenceId,sentence,popupSentenceText,x;return MTPS.Translation.Editor&&MTPS.Translation.Editor.isVisible?null:(sentenceId=$(this).attr("id"),sentence=MTPS.Translation.MTSentences[sentenceId],sentence==null)?null:(popupSentenceText=sentence.getPopupText(),popupSentenceText==null||popupSentenceText.length===0)?null:(MTPS.Translation.InitialHighlightedSentenceId&&(x=MTPS.Translation.MTSentences[MTPS.Translation.InitialHighlightedSentenceId],x.deselectCurrent(),MTPS.Translation.InitialHighlightedSentenceId=null),MTPS.Translation.EditorLink&&(popupSentenceText+='<div class="EditTranslation">',popupSentenceText+=MTPS.Translation.EditorLink.includeEditor==1?"<a href='javascript:void(0);' onclick='MTPS.Translation.ShowEditor(\""+sentenceId+"\");'>":'<a href="'+MTPS.Translation.EditorLink.editLink+"?sentenceGuid="+sentence.sentenceGuid+'">',popupSentenceText+=MTPS.Translation.EditorLink.editLinkText+"<\/a><\/div>"),popupSentenceText)};MTPS.Translation.Init=function(w){var next,previous;MTPS.Translation.MTSentences={};$(".sentence[data-guid]").filter(function(index){var dataSource,approvedData;return MTPS.Translation.TranslationType=="0"?(dataSource=$(this).data("source"),dataSource!=null&&dataSource.length>0&&dataSource.length<=MTPS.Translation.maxPopupTextLength+100):(approvedData=$(this).data("approved"),approvedData!=null&&approvedData.length>0&&approvedData.length<=MTPS.Translation.maxPopupTextLength+100)}).each(function(){MTPS.Translation.MTSentences[$(this).attr("id")]=MTPS.Translation.TranslationType=="0"?new MTPS.Translation.Sentence($(this).attr("id"),$(this).data("source"),$(this).html(),$(this).data("guid"),previous):new MTPS.Translation.Sentence($(this).attr("id"),$(this).html(),$(this).data("approved"),$(this).data("guid"),previous);previous&&(MTPS.Translation.MTSentences[previous].next=$(this).attr("id"));MTPS.Translation.InitialSentence&&MTPS.Translation.InitialSentence==MTPS.Translation.MTSentences[$(this).attr("id")].sentenceGuid&&(MTPS.Translation.InitialHighlightedSentenceId=$(this).attr("id"),w.location.hash=$(this).attr("id"),MTPS.Translation.MTSentences[MTPS.Translation.InitialHighlightedSentenceId].selectCurrent());previous=$(this).attr("id")});$(".translatechoice").bind("click",function(){this.value!=MTPS.Translation.TranslationType&&(MTPS.Translation.TranslationType=this.value,epx.utilities.setCookie("MtpsLibraryTranslator",this.value,365,"/",".microsoft.com",null),w.location.reload())});MTPS.Translation.EditorLink&&MTPS.Translation.EditorLink.includeEditor==1&&(MTPS.Translation.Editor=new $.Microsoft.Mtps.TranslationEditor(MTPS.Translation.TranslationType),MTPS.Translation.ShowEditor=function(sentenceid){MTPS.Translation.Editor.showEditor(MTPS.Translation.MTSentences[sentenceid])});$(".sentence[data-guid]").filter(function(index){var dataSource,approvedData;return MTPS.Translation.TranslationType=="0"?(dataSource=$(this).data("source"),dataSource!=null&&dataSource.length>0&&dataSource.length<=MTPS.Translation.maxPopupTextLength+100):(approvedData=$(this).data("approved"),approvedData!=null&&approvedData.length>0&&approvedData.length<=MTPS.Translation.maxPopupTextLength+100)}).popups({onlySiglePopup:!1,popupIndex:1,activation:"hover",width:"auto",positionBy:"above",popupClass:"MTPopup",showShadow:!1,leftOffset:0,topOffset:-7,mouseLeaveClose:!0,showClose:!1,local:!0,hoverClass:"SentenceHover",allowLinkMouseLeaveClose:!0,getSource:MTPS.Translation.getSource})};$(document).ready(function(){MTPS.Translation.Init(window)});;
